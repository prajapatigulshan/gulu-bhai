<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>GBG Alsi Car Game - Final</title>
<style>
  body { margin:0; overflow:hidden; font-family: Arial; background: #000; color:white; }
  canvas { display:block; margin:0 auto; background:#111; }
  #startBtn { 
    position:absolute; top:50%; left:50%; transform:translate(-50%,-50%);
    padding:20px 40px; font-size:24px; cursor:pointer;
    background: linear-gradient(90deg, red,orange,yellow,green,cyan,blue,violet);
    -webkit-background-clip: text; -webkit-text-fill-color: transparent;
    animation: rgbMove 6s linear infinite; border:2px solid #00ffc8; border-radius:12px;
  }
  @keyframes rgbMove {
    0%{background-position:0% 50%;}
    50%{background-position:100% 50%;}
    100%{background-position:0% 50%;}
  }
  #controls { position:fixed; bottom:20px; left:50%; transform:translateX(-50%); display:flex; gap:20px; }
  .btn { padding:20px; font-size:20px; border-radius:10px; border:none; cursor:pointer;
        background: linear-gradient(90deg, red,orange,yellow,green,cyan,blue,violet);
        -webkit-background-clip: text; -webkit-text-fill-color: transparent; animation: rgbMove 6s linear infinite;}
  #console { position:fixed; left:0; top:0; width:200px; height:100%; background: rgba(0,0,0,0.9);
             color:#0f0; padding:10px; font-family:monospace; overflow:auto; }
  #console input { width:100%; background:#000; color:#0f0; border:none; outline:none; }
  #scoreBoard { position:fixed; top:10px; right:10px; font-size:20px; background:rgba(0,0,0,0.7); padding:10px; border-radius:10px; }
</style>
</head>
<body>

<canvas id="gameCanvas" width="400" height="600"></canvas>
<button id="startBtn">ðŸš€ Start Game</button>

<div id="controls">
  <button class="btn" id="leftBtn">â¬…</button>
  <button class="btn" id="rightBtn">âž¡</button>
</div>

<div id="scoreBoard">Score: 0 | Coins: 0 | Speed: 5</div>

<div id="console">
  <div id="log">> Welcome to GBG Alsi Car Game<br>> Commands: speed+, speed-, coin+N, score+N, reset<br></div>
  <input type="text" id="cmdInput" placeholder="Enter command and press Enter">
</div>

<script>
const canvas = document.getElementById("gameCanvas");
const ctx = canvas.getContext("2d");
const startBtn = document.getElementById("startBtn");
const leftBtn = document.getElementById("leftBtn");
const rightBtn = document.getElementById("rightBtn");
const scoreBoard = document.getElementById("scoreBoard");
const log = document.getElementById("log");
const cmdInput = document.getElementById("cmdInput");

let gameStarted = false;
let car = { x:170, y:500, w:60, h:100 };
let keys = { left:false, right:false };
let obstacles = [];
let coins = [];
let speed = 5;
let score = 0;
let coinCount = 0;
let spawnCounter = 0;

// Start game
startBtn.addEventListener("click", ()=>{
  gameStarted = true;
  startBtn.style.display="none";
});

// Mobile buttons
leftBtn.addEventListener("touchstart",()=>keys.left=true);
leftBtn.addEventListener("touchend",()=>keys.left=false);
rightBtn.addEventListener("touchstart",()=>keys.right=true);
rightBtn.addEventListener("touchend",()=>keys.right=false);

// Keyboard
window.addEventListener("keydown", e => {
  if(e.code=="ArrowLeft") keys.left=true;
  if(e.code=="ArrowRight") keys.right=true;
});
window.addEventListener("keyup", e => {
  if(e.code=="ArrowLeft") keys.left=false;
  if(e.code=="ArrowRight") keys.right=false;
});

// Command console
cmdInput.addEventListener("keydown",(e)=>{
  if(e.key==="Enter"){
    const cmd = cmdInput.value.trim();
    log.innerHTML += "<br>> "+cmd;
    executeCommand(cmd);
    cmdInput.value="";
    log.scrollTop = log.scrollHeight;
  }
});

function executeCommand(cmd){
  if(cmd=="speed+") speed+=2;
  else if(cmd=="speed-") speed=Math.max(1,speed-2);
  else if(cmd.startsWith("coin+")){
    const n = parseInt(cmd.split("+")[1]); if(!isNaN(n)) coinCount+=n;
  }
  else if(cmd.startsWith("score+")){
    const n = parseInt(cmd.split("+")[1]); if(!isNaN(n)) score+=n;
  }
  else if(cmd=="reset"){ location.reload(); }
  updateScoreBoard();
}

// Voice commands
let recognition;
if('webkitSpeechRecognition' in window){
  recognition = new webkitSpeechRecognition();
  recognition.continuous = true;
  recognition.lang = 'en-US';
  recognition.onresult = function(event){
    let transcript = event.results[event.results.length-1][0].transcript.trim().toLowerCase();
    if(transcript.includes("left")) keys.left=true; 
    else keys.left=false;
    if(transcript.includes("right")) keys.right=true;
    else keys.right=false;
  };
}

// Start voice recognition when game starts
startBtn.addEventListener("click",()=>{
  if(recognition) recognition.start();
});

// Game loop
function gameLoop(){
  ctx.clearRect(0,0,canvas.width,canvas.height);

  if(gameStarted){
    // Move car
    if(keys.left) car.x -= speed;
    if(keys.right) car.x += speed;
    if(car.x<0) car.x=0; if(car.x>canvas.width-car.w) car.x=canvas.width-car.w;

    // Spawn obstacles and coins
    spawnCounter++;
    if(spawnCounter % 50 === 0){
      obstacles.push({ x: Math.random()*340, y:-50, w:60, h:60 });
      coins.push({ x: Math.random()*340, y:-50, w:30, h:30 });
    }

    // Move obstacles
    obstacles.forEach(o=>{ o.y+=speed; ctx.fillStyle="red"; ctx.fillRect(o.x,o.y,o.w,o.h); });
    coins.forEach(c=>{ c.y+=speed; ctx.fillStyle="yellow"; ctx.beginPath(); ctx.arc(c.x+15,c.y+15,15,0,Math.PI*2); ctx.fill(); });

    // Collision with obstacles
    for(let o of obstacles){
      if(car.x<o.x+o.w && car.x+car.w>o.x && car.y<o.y+o.h && car.y+car.h>o.y){
        alert("ðŸ’¥ Game Over! Score: "+Math.floor(score)+" Coins: "+coinCount);
        location.reload();
      }
    }

    // Collect coins
    coins.forEach((c,i)=>{
      if(car.x<c.x+c.w && car.x+car.w>c.x && car.y<c.y+c.w && car.y+car.h>c.y){
        coinCount++;
        coins.splice(i,1);
      }
    });

    // Update score by distance
    score += 0.1;
    updateScoreBoard();
  }

  // Draw car
  ctx.fillStyle="cyan";
  ctx.fillRect(car.x,car.y,car.w,car.h);

  requestAnimationFrame(gameLoop);
}

function updateScoreBoard(){
  scoreBoard.innerHTML = "Score: "+Math.floor(score)+" | Coins: "+coinCount+" | Speed: "+speed;
}

gameLoop();
</script>
</body>
</html>
