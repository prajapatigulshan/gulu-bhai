<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>GBG Ultimate Car Game</title>
<style>
body { margin:0; font-family:Arial,sans-serif; background: linear-gradient(270deg, red, orange, yellow, green, cyan, blue, violet, red); background-size: 2000% 2000%; animation: bgRGB 60s linear infinite; color:white; overflow:hidden;}
@keyframes bgRGB { 0%{background-position:0% 50%;}50%{background-position:100% 50%;}100%{background-position:0% 50%;} }
.rgb-text { background: linear-gradient(90deg, red, orange, yellow, green, cyan, blue, violet, red); -webkit-background-clip:text; -webkit-text-fill-color:transparent; background-size:400%; animation: rgbMove 8s linear infinite; font-weight:bold;}
@keyframes rgbMove {0%{background-position:0% 50%;}50%{background-position:100% 50%;}100%{background-position:0% 50%;}}
header { position:fixed; top:0; width:100%; background: rgba(0,0,0,0.85); padding:15px; box-shadow:0 0 15px #00ffc8; z-index:1000; display:flex; justify-content:space-between; align-items:center; }
#startBtn { padding:15px 30px; font-size:18px; border:none; border-radius:12px; cursor:pointer; background: linear-gradient(90deg, red,orange,yellow,green,cyan,blue,violet); animation:rgbMove 6s linear infinite; color:white; box-shadow:0 0 15px #00ffc8; }
canvas { display:block; margin:auto; background:#87CEEB; border:3px solid rgba(0,255,200,0.7); border-radius:12px; margin-top:70px;}
.controls { position:fixed; bottom:20px; width:100%; display:flex; justify-content:center; gap:20px; }
.controls button { padding:15px; font-size:20px; border:none; border-radius:12px; cursor:pointer; background: linear-gradient(90deg, red,orange,yellow,green,cyan,blue,violet); color:white; animation:rgbMove 6s linear infinite; }
#commandPrompt { position:fixed; left:10px; top:80px; width:300px; height:400px; background:rgba(0,0,0,0.9); overflow-y:auto; padding:10px; border-radius:12px; box-shadow:0 0 15px #00ffc8; font-family:monospace; }
#commandPrompt input { width:90%; padding:5px; margin-top:10px; border-radius:5px; border:none; }
#leaderboard { position:fixed; right:10px; top:80px; width:250px; height:400px; background:rgba(0,0,0,0.9); overflow-y:auto; padding:10px; border-radius:12px; box-shadow:0 0 15px #00ffc8; }
#gameOverPopup { display:none; position:fixed; top:50%; left:50%; transform:translate(-50%,-50%); background:rgba(0,0,0,0.85); padding:30px; border-radius:15px; text-align:center; box-shadow:0 0 25px #00ffc8; }
#gameOverPopup button { padding:10px 20px; margin-top:15px; border:none; border-radius:10px; cursor:pointer; background: linear-gradient(90deg, red,orange,yellow,green,cyan,blue,violet); color:white; animation:rgbMove 6s linear infinite; }
</style>
</head>
<body>
<header>
  <div class="logo rgb-text">GBG Car Game</div>
  <button id="startBtn">Start Game</button>
</header>

<div id="commandPrompt">
  <p>// Command Prompt: Use commands (speed X, coin X)</p>
  <input type="text" id="cmdInput" placeholder="Type command and press Enter">
</div>

<div id="leaderboard"><h3 class="rgb-text">Leaderboard</h3><ol id="scoreList"></ol></div>
<canvas id="game" width="800" height="400"></canvas>
<div class="controls">
  <button id="leftBtn">⬅️</button>
  <button id="rightBtn">➡️</button>
</div>
<div id="gameOverPopup">
  <h2 class="rgb-text">Game Over!</h2>
  <p id="finalScore"></p>
  <button onclick="restartGame()">OK</button>
</div>

<script>
const canvas = document.getElementById('game');
const ctx = canvas.getContext('2d');

let gameStarted = false;
let speed = 5;
let score = 0;
let coins = [];
let coinSize = 20;
let player = {x: 100, y: 300, w:50, h:50};
let keys = {};
let highScores = JSON.parse(localStorage.getItem('highScores')) || [];

function startGame(){
  gameStarted = true;
  score = 0;
  coins = [];
  spawnCoin();
  player.x = 100; player.y = 300;
  document.getElementById('startBtn').style.display='none';
  requestAnimationFrame(gameLoop);
}

document.getElementById('startBtn').addEventListener('click', startGame);

function spawnCoin(){
  let x = Math.random() * (canvas.width-coinSize);
  let y = Math.random() * (canvas.height-coinSize-50);
  coins.push({x,y});
}

function draw(){
  ctx.clearRect(0,0,canvas.width,canvas.height);
  ctx.fillStyle='red';
  ctx.fillRect(player.x, player.y, player.w, player.h);
  ctx.fillStyle='yellow';
  coins.forEach(c=>ctx.fillRect(c.x,c.y,coinSize,coinSize));
  ctx.fillStyle='black';
  ctx.font='20px Arial';
  ctx.fillText('Score: '+score,10,30);
}

function update(){
  if(keys['ArrowLeft']) player.x-=speed;
  if(keys['ArrowRight']) player.x+=speed;

  coins.forEach((c,i)=>{
    if(player.x< c.x+coinSize && player.x+player.w>c.x && player.y<c.y+coinSize && player.y+player.h>c.y){
      coins.splice(i,1);
      score++;
      spawnCoin();
      renderLeaderboard(); // realtime update
    }
  });

  if(player.x<0) player.x=0;
  if(player.x+player.w>canvas.width) player.x=canvas.width-player.w;

  // Game over condition
  if(score>=20){ // adjust as you like
    endGame();
  }
}

function gameLoop(){
  if(!gameStarted) return;
  update();
  draw();
  requestAnimationFrame(gameLoop);
}

function endGame(){
  gameStarted=false;
  document.getElementById('finalScore').innerText='Coins collected: '+score;
  document.getElementById('gameOverPopup').style.display='block';
  let playerName = prompt('Enter your name:');
  if(playerName){
    highScores.push({name:playerName, score});
    highScores.sort((a,b)=>b.score-a.score);
    localStorage.setItem('highScores', JSON.stringify(highScores));
    renderLeaderboard();
  }
}

function restartGame(){
  document.getElementById('gameOverPopup').style.display='none';
  startGame();
}

function renderLeaderboard(){
  const list = document.getElementById('scoreList');
  list.innerHTML='';
  highScores.slice(0,10).forEach(hs=>{
    let li=document.createElement('li');
    li.innerText=hs.name+' - '+hs.score;
    list.appendChild(li);
  });
}
renderLeaderboard();

// Controls
window.addEventListener('keydown', e=>keys[e.key]=true);
window.addEventListener('keyup', e=>keys[e.key]=false);
document.getElementById('leftBtn').addEventListener('touchstart',()=>keys['ArrowLeft']=true);
document.getElementById('leftBtn').addEventListener('touchend',()=>keys['ArrowLeft']=false);
document.getElementById('rightBtn').addEventListener('touchstart',()=>keys['ArrowRight']=true);
document.getElementById('rightBtn').addEventListener('touchend',()=>keys['ArrowRight']=false);

// Command input
document.getElementById('cmdInput').addEventListener('keydown', function(e){
  if(e.key==='Enter'){
    executeCommand(this.value);
    this.value='';
  }
});

function executeCommand(cmd){
  const parts = cmd.trim().split(' ');
  if(parts[0]==='speed'){
    let val=parseInt(parts[1]); if(!isNaN(val)) speed=val;
  } else if(parts[0]==='coin'){
    let val=parseInt(parts[1]); if(!isNaN(val)) for(let i=0;i<val;i++) spawnCoin();
    renderLeaderboard(); // coins added, update
  }
}
</script>
</body>
</html>
