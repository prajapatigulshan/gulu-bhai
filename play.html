<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>GBG Parkour</title>
<style>
  body {
    margin: 0;
    overflow: hidden;
    background: linear-gradient(270deg, red, orange, yellow, green, cyan, blue, violet, red);
    background-size: 1500% 1500%;
    animation: bgRGB 30s ease infinite;
  }
  @keyframes bgRGB {
    0% {background-position:0% 50%;}
    50% {background-position:100% 50%;}
    100% {background-position:0% 50%;}
  }
  canvas {
    display: block;
    margin: 0 auto;
    background: #87CEEB;
  }
</style>
</head>
<body>
<canvas id="gameCanvas" width="800" height="500"></canvas>
<script>
const canvas = document.getElementById('gameCanvas');
const ctx = canvas.getContext('2d');

const GRAVITY = 0.5;
const JUMP = -10;

let keys = {};

// Map blocks (x, y, width, height, image)
const blocks = [
  {x: 0, y: 450, w: 200, h: 50, img: 'https://i.imgur.com/O3e7F5h.png'},
  {x: 250, y: 400, w: 150, h: 50, img: 'https://i.imgur.com/O3e7F5h.png'},
  {x: 450, y: 350, w: 150, h: 50, img: 'https://i.imgur.com/O3e7F5h.png'},
  {x: 650, y: 300, w: 150, h: 50, img: 'https://i.imgur.com/O3e7F5h.png'},
];

// Coins (x, y, collected, image)
const coins = [
  {x: 280, y: 370, collected:false, img:'https://i.imgur.com/3bX2rjv.png'},
  {x: 480, y: 320, collected:false, img:'https://i.imgur.com/3bX2rjv.png'},
  {x: 680, y: 270, collected:false, img:'https://i.imgur.com/3bX2rjv.png'},
];

// Player sprite
const playerImg = new Image();
playerImg.src = 'https://i.imgur.com/1X3eZ4s.png'; // small Minecraft-style character
let player = {x:50, y:400, w:40, h:50, dx:0, dy:0, onGround:false};

document.addEventListener('keydown', e=> keys[e.code] = true);
document.addEventListener('keyup', e=> keys[e.code] = false);

function update() {
  // Horizontal movement
  if(keys['ArrowRight']) player.dx = 5;
  else if(keys['ArrowLeft']) player.dx = -5;
  else player.dx = 0;

  // Jump
  if(keys['Space'] && player.onGround) {
    player.dy = JUMP;
    player.onGround = false;
  }

  // Gravity
  player.dy += GRAVITY;
  player.x += player.dx;
  player.y += player.dy;

  // Collision
  player.onGround = false;
  blocks.forEach(block => {
    if(player.x < block.x + block.w &&
       player.x + player.w > block.x &&
       player.y < block.y + block.h &&
       player.y + player.h > block.y) {

      // Collision from top
      if(player.dy > 0 && player.y + player.h - player.dy <= block.y) {
        player.y = block.y - player.h;
        player.dy = 0;
        player.onGround = true;
      }
      // Collision from bottom
      else if(player.dy < 0 && player.y >= block.y + block.h - player.dy) {
        player.y = block.y + block.h;
        player.dy = 0;
      }
      // Side collisions
      else if(player.dx > 0) player.x = block.x - player.w;
      else if(player.dx < 0) player.x = block.x + block.w;
    }
  });

  // Collect coins
  coins.forEach(coin => {
    if(!coin.collected &&
       player.x < coin.x + 30 &&
       player.x + player.w > coin.x &&
       player.y < coin.y + 30 &&
       player.y + player.h > coin.y) {
         coin.collected = true;
         // Coin sound
         let audio = new Audio('https://freesound.org/data/previews/341/341695_3248244-lq.mp3');
         audio.play();
       }
  });
}

function draw() {
  ctx.clearRect(0,0,canvas.width,canvas.height);

  // Draw blocks
  blocks.forEach(block => {
    let img = new Image();
    img.src = block.img;
    ctx.drawImage(img, block.x, block.y, block.w, block.h);
  });

  // Draw coins
  coins.forEach(coin => {
    if(!coin.collected) {
      let img = new Image();
      img.src = coin.img;
      ctx.drawImage(img, coin.x, coin.y, 30, 30);
    }
  });

  // Draw player
  ctx.drawImage(playerImg, player.x, player.y, player.w, player.h);

  // Score
  ctx.fillStyle = 'yellow';
  ctx.font = '20px Arial';
  let score = coins.filter(c => c.collected).length;
  ctx.fillText(`Coins: ${score}`, 10, 30);
}

function gameLoop() {
  update();
  draw();
  requestAnimationFrame(gameLoop);
}
gameLoop();
</script>
</body>
</html>
